!function(t){favoritsProductsIDsController=function(t){this.pids=t},favoritsProductsIDsController.prototype.updatePids=function(t){this.pids=t,this.processPids()},favoritsProductsIDsController.prototype.addPid=function(t){this.pids.push(t),this.processPids()},favoritsProductsIDsController.prototype.removePid=function(r){var o=t.inArray(r,this.pids);o>-1&&delete this.pids[o],this.processPids()},favoritsProductsIDsController.prototype.processPids=function(){var r=this.pids,o=this;t(".favorits-toggle-link[data-pid], .in-favorits-marker[data-pid]").each(function(){var e=t(this),s=e.data("pid"),a=t.inArray(s,r)>-1;o.setElementProps(e,a)}),this.pids.length>0?t('ul.menu a[href="/shop/favorits-products"]').attr("data-favorits-count",this.pids.length):t('ul.menu a[href="/shop/favorits-products"]').removeAttr("data-favorits-count")},favoritsProductsIDsController.prototype.setElementProps=function(t,r){var o,e;r?(t.addClass("in-favorits"),o=t.data("inFavText"),e=t.data("inFavTitle")):(t.removeClass("in-favorits"),o=t.data("notInFavText"),e=t.data("notInFavTitle")),o&&t.text(o),e&&t.attr("title",e)},Drupal.favoritsProductsIDs=Drupal.favoritsProductsIDs||new favoritsProductsIDsController([]),Drupal.behaviors.beeshop_cart={attach:function(r){t("a.clear-favorits").once().click(function(){swal({title:Drupal.t("Are you sure?"),text:Drupal.t("To clear favorites products list"),type:"warning",showCancelButton:!0,confirmButtonText:Drupal.t("Yes, clear it!"),cancelButtonText:Drupal.t("No!"),preConfirm:function(){return new Promise(function(r,o){t.get("/shop/ajax/product-favorits-clear").fail(function(){swal.insertQueueStep("Error.")}).always(function(){r()})})}}).then(function(){swal({type:"success",title:Drupal.t("Clear favorits"),html:Drupal.t("Your favorits list cleared!")}).then(function(t){window.location="/shop"})})}),t("a.favorits-toggle-link").once().click(function(){var r=t(this),o=r.data("pid"),e=r.data("needConfirmForRemove");return requestFuntion=function(e){e=e||function(){},t.ajax({url:r.attr("href"),dataType:"json",statusCode:{200:function(e){if(e.resultCode)switch(e.resultCode){case"added":Drupal.favoritsProductsIDs.addPid(o);break;case"removed":Drupal.favoritsProductsIDs.removePid(o),r.parents(".fav-product-item").length>0&&(r.parents(".fav-product-item").remove(),0==t(".fav-product-item").length&&window.location.reload())}},403:function(r,o,e){if("undefined"!=typeof swal&&Drupal.settings.BeeShop.favorits&&Drupal.settings.BeeShop.favorits.onAccessDenideMessage){var s={type:"error",html:Drupal.t('Please <a href="/user">login</a> or <a href="/user/register">register</a> for using favorits functions'),title:Drupal.t("Favorits products")};t.extend(!0,s,Drupal.settings.BeeShop.favorits.onAccessDenideMessage),swal(s)}}},error:function(t,r,o){}}).always(function(){e()})},e&&1==e?swal({title:Drupal.t("Are you sure?"),text:Drupal.t("To remove this product from your favorites products list"),type:"warning",showCancelButton:!0,confirmButtonText:Drupal.t("Yes"),cancelButtonText:Drupal.t("No"),preConfirm:function(){return new Promise(function(t,r){requestFuntion(t)})}}):requestFuntion(),!1}),t.ajax({url:"/shop/ajax/get_user_favorits_data",dataType:"json",statusCode:{200:function(t){t.length&&t.length>0&&Drupal.favoritsProductsIDs.updatePids(t)}}})}}}(jQuery);
//# sourceMappingURL=maps/bsFavoritsProducts.js.map
